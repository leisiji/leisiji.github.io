---
title: 有限元笔记一
date: 2018-02-16 08:40:40
tags:
---


# 简单问题的解析求解
## 1D 拉杆问题
有一根左端固定的拉杆, 其右端承受一外力 P. 拉杆长度 l, 横截面积 A, 弹性模量 E.
<!--more-->

1. 平衡方程 (无体力): $ \dfrac{d \sigma\_x}{dx}=0$
2. 几何方程: $\varepsilon\_x=\dfrac{du}{dx}$
3. 物理方程: $\varepsilon\_x=\dfrac{\sigma\_x}{E}$
4. 边界条件: $$ \begin{split} BC(u): \quad u(x) \Big| \_{x=0}=0 \\ BC(p): \quad \sigma\_x(x) \Big|\_{x=l}=\dfrac{P}{A}= \overline{p}\_x \end{split}$$

求解, 联立三个方程: 
$$
\begin{split}
\sigma\_x=c \\
\varepsilon_x=\dfrac{c}{E} \\
u(x)=\dfrac{c}{E}+c\_1
\end{split}
$$
其中 $c, c\_1$ 为待定系数, 通过带入边界条件, $c\_1=0, c=\dfrac{P}{A}$


## 平面梁的弯曲问题
![](/images/平面梁弯曲问题.jpg)

1. 平衡方程: $\Sigma x=0, \Sigma Y=0, \Sigma M_0=0$, 其中 $\hat{y}$ 是以梁的中性层为起点的 y 坐标
$$\begin{split}
M=\int\_A \sigma\_x \cdot \hat{y} \cdot dA \\
dQ+\overline{p}(x) \cdot dx=0 , \quad \dfrac{dQ}{dx}+\overline{p}=0 \\
dM-Qdx=0, \quad Q=\dfrac{dM}{dx}
\end{split}$$

2. 几何方程: 
考虑中性层 $ \hat{y}=0$ 处, 根据变形后的几何关系,
$$\varepsilon\_x(\hat{y})= \dfrac{(R-\hat{y}) \cdot d \theta - R \cdot d \theta}{R \cdot \theta} = -\dfrac{\hat{y}}{R}$$
其中 R 为曲率半径, 而曲率 $\kappa $ 与曲率半径 R 的关系为, 梁的挠度函数 $v(x, \hat{y}=0)$: 
$$\kappa = \dfrac{d \theta}{dS} = \dfrac{d \theta}{R \cdot d \theta} = \dfrac{1}{R} \\
\kappa = \pm \dfrac{v''(x)}{( 1 + v'(x)^2)^{3/2}} \approx \pm v''(x) = \dfrac{d^2 v}{ dx^2} \\
\text{因此} \quad \varepsilon(x, \hat{y}) = -\hat{y} \dfrac{d^2 v}{dx^2}  $$

3. 物理方程:  $\sigma\_x = E \varepsilon\_x$

综合以上的方程:
$$
\begin{split}
-EI \dfrac{d^4 v}{dx^4} + \overline{p}(x) = 0 , \quad  I = \int\_A \hat{y}^2 dA\\
M(x) = -EI \dfrac{d^2 v}{dx^2} \\
\sigma\_x = -E \hat{y} \dfrac{d^v}{dx^2} \\
\varepsilon\_x = - \hat{y} \dfrac{d^2 v}{dx^2}
\end{split}
$$
4. 边界条件:
$$
\begin{split}
BC(u): \quad v \Big|\_{x=0} = 0, \quad v \Big|\_{x=l} = 0 \\
BC(p): \quad M \Big|\_{x=0} = 0, \quad M \Big|\_{x=l} = 0 \\
\text{根据 v 和 M 的关系}, \\
BC(p): \quad v'' \Big|\_{x=0} = 0, \quad v'' \Big|\_{x=l} = 0
\end{split}
$$
5. 方程的求解, 解 4 阶微分方程, 结果就不列出了. 

## 关于张量的理解和描述
计算该一阶张量的特征不变量就是模. 
有两个不同坐标系 1 , 2, 则他们之间存在一个转换关系, $l = cos \alpha , m = sin \alpha$:
$$
\begin{bmatrix}
\sigma^{(2)}\_{xx} & \sigma^{(2)}\_{xy} \\
\sigma^{(2)}\_{yx} & \sigma^{(2)}\_{yy} \\
\end{bmatrix} = 
\begin{bmatrix}
l & m \\
-m & l
\end{bmatrix} 
\begin{bmatrix}
\sigma^{(1)}\_{xx} & \sigma^{(1)}\_{xy} \\
\sigma^{(1)}\_{yx} & \sigma^{(1)}\_{yy} \\
\end{bmatrix} 
\begin{bmatrix}
l & -m \\
m & l
\end{bmatrix} 
$$

# 弹性力学问题的近似求解的加权残值法
针对三大类方程和两个边界条件求解三大类变量往往是非常的复杂. 因此一般使用试函数去近似求解. 
试函数 (trial function) 的基本原理是: 先假定满足一定边界条件的试函数, 然后将其带入需要求解的方程中 (即控制方程, governing equation), 通过使与原方程的误差残值最小来确定试函数中的待定系数. 
加权残值法 WRN (weighted residual method), 又分为 Galerkin 加权残值法和残值最小二乘法 (least squares method).


## 梁弯曲问题近似求解的 Galerkin 加权残值法 :
设问题的提法为, 求解 v(x), 使其满足以下方程和边界条件:

$$
\left.
\begin{aligned}
& L(v(x))+\overline{b}&=0 \\
& BC(u): \quad g\_u(v(x))&=0 \\
& BC(p): \quad g\_p(v(x))&=0
\end{aligned}
\right \}
$$
其中$L( )$ 为微分算子; 例如, 对于梁的弯曲问题, 他为 $-EI\dfrac{d^4}{dx^4}, \overline{p}(x)$, 存在的残差 (residual error), 记为:
$$R=L(\hat{v}(x))+\overline{b} \neq 0 \\
\hat{v}(x)=c\_i \phi\_i(x), \quad i=1 \sim n$$

若将 $\hat{v}(x)$ 带入原始方程, 则必有残值 R, 真实的 $c\_1...c\_n$, 使得加权残值的积分为 0, 即:
$$
\left.
\begin{aligned}
& \int\_\Omega w\_{t\_1} \cdot R(c\_1,\dots,c\_n,\phi\_1, \dots,\phi\_n )d\Omega=0 \\
& \int\_\Omega w\_{t\_2} \cdot R(c\_1,\dots,c\_n,\phi\_1, \dots,\phi\_n )d\Omega=0 \\
& \vdots \\
& \int\_\Omega w\_{t\_n} \cdot R(c\_1,\dots,c\_n,\phi\_1, \dots,\phi\_n )d\Omega=0
\end{aligned}
\right \}
$$
以下用例子说明方法的过程:
受均布外载简支梁解法, 梁的两端固定,
将$\hat{v}(x)$ 取为 $\hat{v}\_1(x)=c\_1 \cdot sin\dfrac{\pi x}{l}$
则: 
$$
\begin{split}
R=EI \dfrac{d^4(c\_1 \phi\_1(x))}{dx^4} - \overline{p}\_0 \neq 0 \\
\text{由 Galerkin 加权残值方程} \\
\int\_l \left( sin\dfrac{\pi x}{l} \right) \cdot \left [ 
EI \dfrac{d^4(c\_1 \phi\_1(x))}{dx^4} - \overline{p}\_0\right ]dx=0 
\end{split}$$
取 $w\_{t\_1}= \phi\_1(x)$
求解后: $c\_1=\dfrac{4l^4}{\pi^5 EI} \overline{p}\_0$
同理, 可以通过增加 $c\_2 \cdot sin \dfrac{3 \pi x}{l}$ 来增加求解的精度, 而 $c\_2$ 可以通过增加加权残值方程联立后求出. 

</ br>
**梁弯曲问题近似求解的残值最小二乘法** :
存在 $c\_i$ 使得:
$$\min\_{c\_1, \dots , c\_n} \left[ E\_{rr}= \int\_\Omega w\_t \cdot R^2(c\_1, \dots, c\_n, \phi\_1, \dots, \phi\_n)d\Omega \right]\\
\text{即是} \\
\dfrac{\partial E\_{rr}}{\partial c\_i}=0$$


**一般弹性问题近似求解的加权残值法** :
基于位移表达的平衡方程:
$$
\dfrac{E}{1-\mu^2} \left( \dfrac{\partial^2 u}{\partial x^2} + \dfrac{1-\mu}{2}\dfrac{\partial x^2 u}{\partial y^2} + \dfrac{1 + \mu}{2} \dfrac{\partial^2 u}{\partial x \partial y} \right)+ \overline{b}\_x =0 \\
\dfrac{E}{1-\mu^2} \left( \dfrac{\partial^2 v}{\partial y^2} + \dfrac{1-\mu}{2}\dfrac{\partial x^2 v}{\partial x^2} + \dfrac{1 + \mu}{2} \dfrac{\partial^2 u}{\partial x \partial y} \right)+ \overline{b}\_y =0$$


## 虚功原理
对于一根中间仅有一个铰链固定的杠杆, 对杠杆的两端施加 $P\_A, P\_B$的力, 
则: $\dfrac{P\_A}{P\_B}=\dfrac{l\_A}{l\_B}$
假设该平衡力系上作用微小的扰动, 且外力作用的位置产生了微小的变化, 即$\Delta\_A, \Delta\_B$: $\dfrac{\Delta\_A}{\Delta\_B}=\dfrac{l\_A}{l\_B}, \text{得到}, P\_A \Delta\_A- P\_B \Delta\_B=0$, $P\_A \Delta\_A$ 称作 A 的虚功. 
**虚功原理**: 对于一个处于平衡状态的系统, 当作用满足许可条件的虚位移时, 系统上所有的虚功总和恒为0. ($\delta W- \delta U=0$); 虚功包括外力虚功 $\delta W$ 和内力虚功 $-\delta U$, $\delta U$ 叫做虚应变能. 
以下继续以简支梁问题为例, 说明虚功原理的解题过程:
$$
\hat{v}(x)=c\_1 \cdot sin\dfrac{\pi x}{l}  \\\
\delta \hat{v}(x)=\delta c\_1 \cdot sin\dfrac{\pi x}{l}
$$
$\delta c\_1$ 为微小变化量, 虚应变能为:
$$\delta U= \int\_\Omega \sigma\_x \delta \varepsilon\_x d\Omega= \int\_0^l \int\_A E \cdot \varepsilon\_x \delta \varepsilon\_x dA dx \\\
\varepsilon\_x = - \hat{y} \cdot \dfrac{d^2v}{dx^2} \\\
\text{代入所有量可以得到}\\\
\delta U=EI \int\_l \left(\dfrac{d^2\hat{v}}{dx^2}\right) \cdot \left(\dfrac{d^2 \delta \hat{v}}{dx^2}\right)dx= \dfrac{EIl}{2} \left( \dfrac{\pi}{l} \right)^4 \cdot c\_1 \cdot \delta c\_1 \\\
\delta W= \int\_0^l \overline{p}\_0 \delta v dx = \dfrac{2l\overline{p}\_0}{\pi} \cdot \delta c\_1$$
根据虚功原理可以求出 $c\_1$
若是一般问题, 则需要考虑体积力 $b\_i$.
**为了不失去一般性, 可以令第 m 个参数 $c\_m$ 产生的虚增量 $\delta c\_m \neq 0$, 而其他的虚增量为 0 .(即 $\delta \hat{v} = 0$)**
**最后求出 $c\_m$(关于 m 的一个函数), 再令 m = 1, 2 , ....可以求出各个系数.** ($\delta \hat{v} = \delta c\_m  \cdot sin \dfrac{m \pi x}{l}$)
$$
\delta \varepsilon = \dfrac{1}{2} (\delta u\_{i,j}+ \delta u\_{j,i}) \\\
\delta U = \int\_\Omega \sigma\_{ij} \ \delta \varepsilon\_{ij} \ d \Omega \\\
 \delta W = \int\_\Omega \overline{b}\_i \cdot \delta u\_i \cdot d \Omega + \int\_S \overline{p}\_i \cdot \delta u\_i \cdot dA 
$$
S 为 $S\_p $

## 最小势能原理
设有满足位移边界条件 BC(u) 的许可位移场, 其中真实的位移场 $\hat{u\_i}$ 是物体的总势能取最小值 :
$$
\min\_{\hat{u\_i} \in BC(u)} \left[ \Pi(\hat{u\_i})=U-W \right]
$$
此方法也叫做Rayleigh-Ritz 原理. 
具体算法就是算出 U 和 W, 再使 $\dfrac{\partial \Pi}{\partial c\_i}=0$. 

## 梁弯曲问题最小势能原理求解的变分基础
由于 $\Pi$ 的基本变量为函数 $\hat{x}(x)$, 则求极值的过程为符合函数的求导过程, 也叫做变分过程. 
$$
\min\_{\hat{u\_i} \in BC(u)} \left[ \Pi(\hat{u\_i})= \dfrac{1}{2} \int\_l EI\left(\dfrac{d^2\hat{v}}{dx^2}\right)^2 \cdot dx -\int\_l\overline{p}(x)\hat{v}(x)dx \right] \\\
\delta \Pi= \dfrac{1}{2} EI \int\_l 2\left(\dfrac{d^2\hat v}{dx^2}\right) \cdot \delta \left(\dfrac{d^2\hat{v}}{dx^2}\right)dx - \int\_l \overline{p} \cdot \delta\hat{v}\cdot dx
$$
$\delta$ 为变分符号(即复合函数求微分) 
一些比较重要的公式:
$$
\begin{split}
M= -EI \left(\dfrac{d^2\hat v}{dx^2}\right) = -EI v'' \\
Q= -EI  \left(\dfrac{d^3\hat v}{dx^3}\right) = -EI v''',  \quad \text{Q 为剪力}
\begin{split}
$$

之后的证明请看原书.


