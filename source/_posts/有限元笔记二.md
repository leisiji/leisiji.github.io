---
title: 有限元笔记二
date: 2018-02-16 19:02:20
tags:
---

# 杆梁结构的有限元分析原理
<!--more-->
## 1D 杆单元的研究
**(1) 单元的研究**
他有两个节点, 设位移场为 $u(x)= a\_0+ a\_1 x$

- 单元节点条件: $$ \begin{flalign} u(x) \Big|\_{x=0}=u\_1 \\\\ u(x) \Big|\_{x=l}=u\_2 \\\\ \text{带入条件后} \\\\ a\_0=u\_1, \quad a\_1=\dfrac{u\_2-u\_1}{l^e} \\\\ \text{令} \quad N(x)=\begin{bmatrix} (1-\dfrac{x}{l^e}) &\dfrac{x}{l^e} \end{bmatrix}, \quad q^e=[u\_1 \quad u\_2]^T \\\\ \text{则} \quad u(x)=N(x) \cdot q^e \end{flalign}$$
- 应变的表达: $$\begin{flalign} \varepsilon (x)= \dfrac{du(x)}{dx} = [ -\dfrac{1}{l^e} \quad \dfrac{1}{l^e} ] \begin{bmatrix} u\_1 \\\\ u\_2 \end{bmatrix} = B(x) \cdot q^e \\\\ \text{其中} B(x) \text{叫做几何函数矩阵} \end{flalign} $$
- 应力的表达: $$ \begin{split} \sigma (x) =E^e \varepsilon(x) = E^e \cdot B(x) \cdot q^e = S(x) \cdot q^e \\\\ \text{其中} S(x) = E^e \cdot B(x) = [- \dfrac{E^e}{l^e} \quad \dfrac{E^e}{l^e}], \ \text{叫做应力矩阵} \end{split} $$
- 势能的表达 (基于以上的公式去带入): $$ \begin{split} & \begin{flalign}
\Pi^e & = U^e - W^e  = \dfrac{1}{2} \int\_\Omega \sigma (x) \cdot \varepsilon(x) \cdot d \Omega - (P\_1 \cdot u\_1+ P\_2 \cdot u\_2) \\\\ &= \dfrac{1}{2} \int\_0^{l^e} q^{eT} \cdot S^T(x)  \cdot B(x) \cdot q^e \cdot A^e \cdot dx - (P\_1 \cdot u\_1+ P\_2 \cdot u\_2) \\\\
&= \dfrac{1}{2} [u\_1 \quad u\_2] \begin{bmatrix}
\dfrac{E^e A^e}{l^e} & -\dfrac{E^e A^e}{l^e} \\\\ -\dfrac{E^e A^e}{l^e} & \dfrac{E^e A^e}{l^e}
\end{bmatrix} \begin{bmatrix}
u\_1 \\\\ u\_2
\end{bmatrix} -[P\_1 \quad P\_2] \begin{bmatrix}
u\_1 \\\\ u\_2
\end{bmatrix}
\\\\ &=\dfrac{1}{2} q^{eT} \cdot K^e \cdot q^e - P^{eT}\cdot q^e
\end{flalign} \\\\ & \text{其中} K^e= \dfrac{E^e A^e}{l^e} \begin{bmatrix} 1 & -1 \\\\ -1  & 1\end{bmatrix} \ \text{叫做单元刚度矩阵} \\\\ P^e = [P\_1 \quad P\_2]^T \ \text{叫做节点力列阵} \end{split} $$


**(2)离散单元的装配** :
求出各个单元的势能后, 要进行离散单元的装配 (assembly of discrete element), 其实就是进行矩阵的直接相加. 


**(3)边界条件的处理** :
处理边界条件是获取许可位移场. 即是将 BC(u) 带入装配好的方程中. 比如, BC(u) 为 $u\_1=0$ ,就是将 $u\_1$ 的项划去. 


**(4) 建立刚度方程**:
$$\min\_{u\_2,u\_3} \Pi  \rightarrow \quad \dfrac{\partial \Pi}{\partial u\_2}=0, \dfrac{\partial \Pi}{\partial u\_3}=0, \text{总的来说就是} \dfrac{\partial \Pi}{\partial q^e}=0$$
两个方程化简为同一个方程后叫做刚度方程

**(5) 求解节点位移** :
由于是两个杆单元组成, 2节点为中间节点. 通过刚度方程可以求出后两个节点的位移, 同时节点1 的位移为零. $q=[0 \quad u\_2 \quad u\_3]^T$, 之后通过公式可以求出单元应变和应力, 还有支反力.

## 有限元分析的基本步骤及表达式
1. 物体几何区域的离散化
2. 单元的研究 (参照上一节), **e 的意思就是element**, 补充:$$ \begin{flalign} \Pi^e=\dfrac{1}{2}q^{eT}K^e q^e-P^{eT}q^e \\\\ K^e=\int\_{\Omega\_e} B^T D B   d \Omega , \quad P^e= R^e+ F^e \\\\ \text{单元平衡方程} K^e q^e=P^e \end{flalign} $$
3. 装配集成: $K \cdot q=P, q=\Sigma q^e, K=\Sigma K^e, P= \Sigma P^e$, 要对应单元相加, 即先初始化一个 节点数*节点数 的矩阵, 在对应节点的位置放进矩阵中. 
4. 边界条件 BC(u) 的处理并求节点位移
5. 支反力的求取

## 杆单元及坐标变换
自由度 DOF (Degree of Freedom)
下面的讨论是基于平面杆单元的. 
局部坐标系的节点位移: $q^e = [u\_1 \quad u\_2]^T$
整体坐标系的节点位移: $\overline{q}^e = [\overline{u}\_1 \quad \overline{v}\_1 \quad \overline{u}\_2 \quad \overline{v}\_2]^T$
他们之间存在如下关系:
$$\left.
\begin{flalign}
u\_1 = \overline{u}\_1 \cos \alpha + \overline{v}\_1 \sin \alpha \\\\
u\_2 = \overline{u}\_2 \cos \alpha + \overline{v}\_2 \sin \alpha
\end{flalign}
\right \\} \\\\
\text{写成矩阵} \quad  q^e=
\begin{bmatrix}
\cos \alpha & \sin \alpha & 0 & 0 \\\\ 0 & 0 & \cos \alpha & \sin \alpha
\end{bmatrix} \overline{q}^e = T^e \cdot  \overline{q}^e \\\\ (T^e \text{叫做坐标变换矩阵, transformation matrix})$$
同理: 
$$ \overline{K}^e = T^{eT} K^e T^e, \quad \overline{P}^e=T^{eT} P^e , \quad \overline{K}^e \overline{q}^e=\overline{P}^e$$
对于三维问题: 
$$T\_e= \begin{bmatrix}  \cos (x, \overline{x}) & \cos (x, \overline{y}) & \cos (x, \overline{z}) & 0 & 0 & 0 \\\\  0 & 0 & 0 &\cos (x, \overline{x}) & \cos (x, \overline{y}) & \cos (x, \overline{z})
\end{bmatrix}$$

## 平面纯弯梁单元构建

节点位移: $q^e = [v\_1 \quad \theta\_1 \quad v\_2 \quad \theta\_2]^T $, 有四个自由度
节点力: $P^e= [P\_{v1} \quad M\_1 \quad P\_{v2} \quad M\_2]^T$
**由于有四个自由度, 为了可以解方程**, 设 $v(x) = a\_0 + a\_1 x+ a\_2x^2 + a\_3x^3$
由单元节点条件 $v(x=0) = v\_1, v(x=0)= \theta\_1,v(x=l) = v\_2, v(x=l)= \theta\_2 $, 可以求出 $a\_0 , a\_1 , a\_2, a\_3$, 接下来的步骤与 1D 杆单元类似. 
不同之处 : 

- 第一 $\varepsilon (x,\hat{y}) = -\hat{y} \dfrac{d^2 v(x)}{dx^2}  = B(\xi) \cdot q^e, \text{其中, } \xi=\dfrac{x}{l}$
- 第二, 公式中的惯性矩都是 $I\_z$
- $W^e= P\_{v1} \cdot v\_1 + P\_{v2} \cdot v\_2 + M\_1 \cdot \theta\_1 +M\_2 \cdot \theta\_2 = P^{eT} \cdot q^e$
- 刚度矩阵: $$K^e= \dfrac{EI\_z}{l^3} \begin{bmatrix}
 12 & 6l & -12 & 6l \\\\ 6l & 4l^2 & -6l & 2l^2 \\\\ -12 & -6l & 12 & -6l \\\\ 6l & 2l^2 & -6l & 4l^2 
\end{bmatrix}$$

将拉压杆单元和纯弯曲杆单元组合可以得到一般平面杆单元的刚度矩阵 $q^e = [u\_1 \quad v\_1 \quad \theta\_1 \quad u\_2 \quad v\_2 \quad \theta\_2]^T$, 则刚度矩阵就按照之前的方法去装配, 得到一个 6*6 的刚度矩阵. 

## 平面梁单元的坐标变换
 $q^e = [u\_1 \quad v\_1 \quad \theta\_1 \quad u\_2 \quad v\_2 \quad \theta\_2]^T$
 $\overline{q}^e = [\overline{u}\_1 \quad \overline{v}\_1 \quad \theta\_1 \quad \overline{u}\_2 \quad \overline{v}\_2 \quad \theta\_2]^T$
在局部和整体的平面梁单元的转角是相同的. 
$$\left.
\begin{flaligned}
u\_1 &= \overline{u}\_1 \cos \alpha + \overline{v}\_1 \sin \alpha \\\\
v\_1 &= - \overline{u}\_1 \sin \alpha + \overline{v}\_1 \cos \alpha \\\\
u\_2 & = \overline{u}\_2 \cos \alpha + \overline{v}\_2 \sin \alpha \\\\
v\_2 &= - \overline{u}\_2 \sin \alpha + \overline{v}\_2 \cos \alpha
\end{flaligned}
\right \\}
$$
$q^e = T^e \cdot \overline{q}^e$
观察以下坐标变换矩阵的规律, 与坐标变换的式子对比 : 
$$
T^e = \begin{bmatrix}
\cos \alpha & \sin \alpha & 0 & 0 & 0 & 0 \\\\ -\sin \alpha & \cos \alpha & 0 & 0 & 0 & 0 \\\\ 0& 0& 1 & 0 & 0 & 0 \\\\  0 & 0 & 0 & \cos \alpha & \sin \alpha & 0 \\\\ 0 & 0 & 0 & -\sin \alpha & \cos \alpha & 0 \\\\ 0 & 0 & 0 & 0 & 0 & 1
\end{bmatrix}$$

## 空间梁单元及坐标变换
空间梁单元除了受轴力和弯矩外, 还可能受扭矩. 
$$ 
\begin{flaligned} 
q^e = [u\_1 \quad v\_1 \quad w\_1 \quad \theta\_{x1} \quad \theta\_{y1} \quad \theta\_{z1} \quad u\_2 \quad v\_2 \quad w\_2 \quad \theta\_{x2} \quad \theta\_{y2} \quad \theta\_{z2}]^T \\\\  
P^e = [P\_{u1} \quad P\_{v1} \quad P\_{w1} \quad M\_{x1} \quad M\_{y1} \quad M\_{z1} \quad P\_{u2} \quad P\_{v2} \quad P\_{w2} \quad M\_{x2} \quad M\_{y2} \quad M\_{z2}] 
\end{flaligned}
$$
轴向位移的刚度矩阵:
$$
K^e\_{u\_1 u\_2} = \dfrac{EA}{l} 
\begin{bmatrix}
1 & -1 \\\\ -1 & 1
\end{bmatrix}
$$
多了一个扭转刚度矩阵:
$$ 
K^e\_{\theta\_{x1} \theta\_{x2}} = \dfrac{GJ}{l} 
\begin{bmatrix}
 1 & -1 \\\\ -1 & 1
 \end{bmatrix} \\\\ 
 \text{其中 J 为横截面的扭转惯性矩, G 为剪切模量}
$$
Oxy 平面的节点位移 $v\_1, \theta\_{z1},v\_2, \theta\_{z2}$ :
$$
K^e= \dfrac{EI\_z}{l^3} 
\begin{bmatrix}
 12 & 6l & -12 & 6l \\\\ 6l & 4l^2 & -6l & 2l^2 \\\\ -12 & -6l & 12 & -6l \\\\ 6l & 2l^2 & -6l & 4l^2 
\end{bmatrix}
$$
Oxz 平面的刚度矩阵与 Oxy 的完全一致, 只是 $I\_z$ 要换成 $I\_y$, 最后统一 4 个矩阵可以得到一个 12 \*12 的总体刚度矩阵.  **每个单元需要先进行坐标变换再去相加**.

![](/images/梁单元常用节点载荷.jpg)